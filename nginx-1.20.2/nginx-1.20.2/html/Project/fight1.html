<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Test Fight</title>
<link rel="stylesheet" href="styles.css" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() { 
    $('#chatbox').hide();
    $('#fightbox').hide();
    $('#arrowLeft').hide();
    $('#attackbox').hide();
    $('#skillbox').hide();
    $('#itembox').hide();
    $('#playerinfo').hide();
    $('#fightInstructions').hide();



    $('#firstDevil').show();

    

    var counter = 0;
    var battlecounter = 0;

    var devilHealth = 100;
    var maxDevilHealth = devilHealth;
    var health = 30; // should be local storage value in other fights
    var maxHealth = 100;
    var mana = 100; // should be local storage value in other fights
    var maxMana = 100;
    
    $('#health').css({ 'width': health});//get health into percentage
    $('div#health').text(health +"/"+ maxHealth);
    $('div#mana').text(mana +"/"+ maxMana);


    $("div#stage").click(ClickCommand);

    function ClickCommand(){
        counter++;
        if (counter == 1){
            $('#blur').css({ 'opacity': '0.5'});
            $('div#chattext').text("It's been a while since I last fought.");
            $('#chatbox').show();
        }
        if (counter == 2){
            $('div#chattext').text("Lets hope my skills haven't gotten rusty.");
        }
        if (counter == 3){
            $('#blur').css({ 'opacity': '0'});
            $('#chatbox').hide();
            $('#fightbox').show();
            $('#playerinfo').show();

            //fade in the devil
        }
        if (counter == 4){
            $('#fightInstructions').show();
            $('div#fightInstructionstext').text("Fight the devil in combat. Hover over your attacks and skills for more information.");
        }
        
        if (counter == 5){
            $('#fightInstructions').hide();
            
            battleTurn();
        }
    }

    function devilTurn(){
        $('div#health').text(health +"/"+ maxHealth);
        $('div#mana').text(mana +"/"+ maxMana);
        console.log("mana = " + mana);

        console.log("hp" + devilHealth);
        $('div#enemyhealth').text(devilHealth +"/"+ maxDevilHealth);

        //IF KILLED DEVIL
        if (devilHealth<=0){
            $('#firstDevil').fadeOut(3000);
            localStorage.setItem('playerHealth', health);
            localStorage.setItem('firstDevilDefeat', 'true');
            setTimeout(function(){
                window.location = 'StaffRoom.html';
            },3000)
        }
        if (battlecounter==1){
            console.log("1");
            $('div#chattext').text("devil attacks");
            setTimeout(function(){
                health-=10;
                $('div#health').text(health +"/"+ maxHealth);
                $('#health').css({ 'width': '-=10%'});
                $('#chatbox').hide();
                $('#actions').show();
                if (health<=0){
                console.log("DEAD");
                Dead();
                }
            },1500)
        }
        if (battlecounter==2){
            console.log("2");
            $('div#chattext').text("devil attacks 2");
            setTimeout(function(){
                health-=10;
                $('div#health').text(health +"/"+ maxHealth);
                $('#health').css({ 'width': '-=10%'});
                $('#chatbox').hide();
                $('#actions').show();
                if (health<=0){
                    console.log("DEAD");
                    Dead();
                }
            },1500)
        }
        if (battlecounter==3){
            console.log("3");
            $('div#chattext').text("devil attacks 3");
            setTimeout(function(){
                health-=30;
                $('div#health').text(health +"/"+ maxHealth);
                $('#health').css({ 'width': '-=30%'});
                $('#chatbox').hide();
                $('#actions').show();
                if (health<=0){
                    console.log("DEAD");
                    Dead();
                }

            },1500)
        }
        if (battlecounter==4){
            console.log("4");
            $('div#chattext').text("devil attacks 4");
            setTimeout(function(){
                health-=10;
                $('div#health').text(health +"/"+ maxHealth);
                $('#health').css({ 'width': '-=10%'});
                $('#chatbox').hide();
                $('#actions').show();
                if (health<=0){
                    console.log("DEAD");
                    Dead();
                }

            },1500)
        }
        if (battlecounter==5){
            console.log("5");
            $('div#chattext').text("devil attacks 5");
            setTimeout(function(){
                health-=10;
                $('#health').css({ 'width': '-=10%'});
                $('#chatbox').hide();
                $('#actions').show();
                if (health<=0){
                    console.log("DEAD");
                    Dead();
                }
            },1500)
        }
    }

    function Dead(){
        $('#chatbox').show();
        $('div#chattext').text("You have failed. Try again");
        setTimeout(function(){
                    window.location = 'fight1.html';
        },5000)
    }

    function battleTurn(){
        console.log("battle turn");


        $("div#attack").click(function(){
            $('#actions').hide();
            $('#attackbox').show();
            
        })
    $("div#skill").click(function(){
             $('#actions').hide();
            $('#skillbox').show();
    })
    $("div#attack1").click(function(){
            $('#chatname').hide();
            $('#attackbox').hide();
            $('#actions').hide();
            $('#chatbox').show();
            $('div#chattext').text("D used slash!");
            setTimeout(function(){
                console.log("battlecounter ++");
                devilHealth-=10;
                $('#enemyhealth').css({ 'width': '-=10%'});
                battlecounter++;
            
                devilTurn();
  
            },1500)
        })
    $("div#attack2").click(function(){
            
            $('#attackbox').hide();
            $('#actions').show();
            $('#chatname').hide();
            $('#chatbox').show();
            $('div#chattext').text("D used kick!");
            setTimeout(function(){
                devilHealth-=20;
            $('#enemyhealth').css({ 'width': '-=20%'});
                battlecounter++;
                devilTurn();
            },1500)
    })
    $("div#attack3").click(function(){
            
            $('#attackbox').hide();
            $('#chatname').hide();
            $('#actions').show();
            $('#chatbox').show();
            $('div#chattext').text("D used DD!");
            setTimeout(function(){
                devilHealth-=30;
            $('#enemyhealth').css({ 'width': '-=30%'});
                battlecounter++;
                devilTurn();
            },1500)
    })
    $("div#back").click(function(){
            $('#attackbox').hide();
            $('#skillbox').hide();

            $('#actions').show();
    })

    $("div#skill1").click(function(){ //heal shot
        var manatest = mana;
        var healthtest = health;
        if ((manatest-=30)<=0){
            console.log("not enough mana");
        }else{
            
            if ((healthtest+=20) >= maxHealth){
                console.log("hea;ed");
                $('#skillbox').hide();
                $('#chatname').hide();
                $('#actions').show();
                $('#chatbox').show();
                $('div#chattext').text("D used heal shot!");
                    setTimeout(function(){
                    battlecounter++;
                    health = maxHealth;
                    devilHealth-=20;
                    $('#enemyhealth').css({ 'width': '-=20%'});
                    $('#health').css({ 'width': '120px'});
                    mana -= 30;
                    $('#mana').css({ 'width': '-=30%'});
                    $('div#mana').text(mana +"/"+ maxMana);
                    devilTurn();
                },1500)
            } else {
                console.log("hea;ed");
                $('#skillbox').hide();
                $('#chatname').hide();
                $('#actions').show();
                $('#chatbox').show();
                $('div#chattext').text("D used heal shot!");
                    setTimeout(function(){
                    battlecounter++;
                    health+=20;
                    devilHealth-=20;
                    $('#enemyhealth').css({ 'width': '-=20%'});
                    $('#health').css({ 'width': '+=20%'});
                    mana -= 30;
                    $('#mana').css({ 'width': '-=30%'});
                    $('div#mana').text(mana +"/"+ maxMana);
                    devilTurn();
                },1500)
            }

            $('#skillbox').hide();
            $('#chatname').hide();
            $('#actions').show();
            $('#chatbox').show();
            $('div#chattext').text("D used heal shot!");
            setTimeout(function(){
                battlecounter++;
                $('div#mana').text(mana +"/"+ maxMana);
                devilTurn();
            },1500)
        }
        })
    $("div#skill2").click(function(){ // heal
        var manatest = mana;
        var healthtest = health;
        if ((manatest-=40)<=0){
            console.log("not enough mana");
        }else{
            
            if ((healthtest+=50) >= maxHealth){
                $('#chatname').hide();
                $('#skillbox').hide();
                $('#actions').show();
                $('#chatbox').show();
                $('div#chattext').text("D used Pray!");
                setTimeout(function(){
                battlecounter++;
                health = maxHealth;
                
                $('#health').css({ 'width': '120px'});
                mana-=40
                $('#mana').css({ 'width': '-=40%'});
                $('div#mana').text(mana +"/"+ maxMana);
                devilTurn();
                },1500)
            }else{
            $('#chatname').hide();
            $('#skillbox').hide();
            $('#actions').show();
            $('#chatbox').show();
            $('div#chattext').text("D used Pray!");
            setTimeout(function(){
                health+=50
                $('#health').css({ 'width': '+=50%'});
                battlecounter++;
                mana-=40
                $('div#mana').text(mana +"/"+ maxMana);
                $('#mana').css({ 'width': '-=40%'});

                devilTurn();
            },1500)
            }

            
        }
    })
    }
    //attack/skill information
    $("#attack1").mouseover(function () {
        $('div#info').text("Deal 10 Damage");
    });
    $('#attack1').mouseleave(function(){
        $('div#info').text("");
  	});

    $("#attack2").mouseover(function () {
        $('div#info').text("Deal 20 Damage");
    });
    $('#attack2').mouseleave(function(){
        $('div#info').text("");
  	});

    $("#attack3").mouseover(function () {
        $('div#info').text("Deal 30 Damage");
    });
    $('#attack1').mouseleave(function(){
        $('div#info').text("");
  	});

    $("#skill1").mouseover(function () {
        $('div#info').text("Deal 20 Damage and Heal 20 health");
        $('div#infocost').text("30 Mana");
    });
    $('#skill1').mouseleave(function(){
        $('div#info').text("");
        $('div#infocost').text("");
  	});
      
    $("#skill2").mouseover(function () {
        $('div#info').text("Heal 50 health");
        $('div#infocost').text("40 Mana");

    });
    $('#skill2').mouseleave(function(){
        $('div#info').text("");
        $('div#infocost').text("");
  	});
});
</script>
</head>
<body>
<div id ="stage">
    <div id="content">
        <div id="devilName">TEST DEVIL</div>
        <img id="firstDevil" src="firstDevil.png">
        <div id="bar">
            <div id="enemyhealth">100/100</div>
        </div>
    <div id="blur"></div>
    <div id="fightInstructions">
        <div id="fightInstructionstext"></div>
    </div>
    <div id="playerinfo">
        <div id="healthbar">
            <div id="health"></div>
        </div>
        <div id="manabar">
            <div id="mana"></div>
        </div>
    </div>
    <div id="fightbox">
        <div id="actions">
        <div id="attack">Attack</div>
        <div id="skill">Skill</div>
    </div>
    <div id="attackbox">
        <div id="attack1">Slash</div>
        <div id="attack2">Kick</div>
        <div id="attack3">DD</div>
        <div id="info"></div>
        <div id="back">Back</div>
    </div>

    <div id="skillbox">
        <div id="info"></div>
        <div id="infocost"></div>

        <div id="skill1">Heal shot</div>
        <div id="skill2">heal</div>
        <div id="back">Back</div>
    </div>
</div>
<!-- Hover over a move will show a text box on side on information aboiut the move -->


    <div id="chatbox"> 
        <div id="chattext"></div>
        <div id="chatname">D</div>
    </div>
</div>
</div>

</body>
</html>